var albumBucketName='tnrschool-transfer-certificate';AWS.config.region='us-east-2';AWS.config.credentials=new AWS.CognitoIdentityCredentials({IdentityPoolId:'us-east-2:b850f213-98c6-48ef-9aee-c3b1f8ab8116',});var s3=new AWS.S3({apiVersion:'2006-03-01',params:{Bucket:albumBucketName}});function getHtml(template){return template.join('\n')}(function listAlbums(){s3.listObjects({Delimiter:'/'},function(err,data){if(err){return alert('There was an error listing your albums: '+err.message)}else{var albums=data.CommonPrefixes.map(function(commonPrefix){var prefix=commonPrefix.Prefix;var albumName=decodeURIComponent(prefix.replace('/',''));return getHtml(['<li class="col-lg-3 col-md-4 col-sm-6 mb-3">','<button class="bg_pink text-white" onclick="viewAlbum(\''+albumName+'\')">',albumName,'</button>','</li>']);viewAlbum('"'+albumName+'"')});var htmlTemplate=['<ul class="row">',getHtml(albums),'</ul>',]
document.getElementById('viewer').innerHTML=getHtml(htmlTemplate);$('#loader-wrapper2').fadeOut('slow')}})})();function viewAlbum(albumName,page=1){$('#loader-wrapper3').fadeIn('slow');var albumPhotosKey=encodeURIComponent(albumName)+'/';s3.listObjects({Prefix:albumPhotosKey},function(err,data){if(err){return alert('There was an error viewing your album: '+err.message)}
console.log("THIS IS DATA FROM BUCKET",data);var href=this.request.httpRequest.endpoint.href;var bucketUrl=href+albumBucketName+'/';var photos=data.Contents.map(function(photo,index){if(photo.Size>0&&index>=((page-1)*25-1)&&index<=(page*25-1)){var photoKey=photo.Key;var photoUrl=bucketUrl+encodeURIComponent(photoKey);return getHtml(['<tr>','<td>',photoKey.replace(albumPhotosKey,''),'</td>','<td>','<a class="download_certificate text_orange" href="'+photoUrl+'" download="'+photoKey.replace(albumPhotosKey,'')+'"><i class="fa fa-download" aria-hidden="true"></i>Download</a>','</td>','</tr>',])}});var noOfPages=Math.ceil(photos.length/25);var pageArray=new Array(noOfPages).fill(0);var pages=pageArray.map(function(val,index){return getHtml(['<li id="page_'+(index+1)+'"><a href="javascript:viewAlbum(\''+albumName+'\','+(index+1)+');">'+(index+1)+'</a></li>',])})
var htmlTemplate=['<div id="loader-wrapper3" style="display: none;">','<div id="loader3"></div>','</div>','<div class="table-responsive">','<table class="table table-bordered table-striped">','<thead>','<tr>','<th>Name</th>','<th>Action</th>','</tr>','</thead>','<tbody>',getHtml(photos),'</tbody>','</table>','<div class="page_pagination">','<ul>','<li><a href="javascript:viewAlbum(\''+albumName+'\','+(page-1)+');"><i class="fa fa-angle-left" aria-hidden="true"></i></a></li>',getHtml(pages),'<li><a href="javascript:viewAlbum(\''+albumName+'\','+(page+1)+');"><i class="fa fa-angle-right" aria-hidden="true"></i></a></li>','</ul>','</div>','</div>',]
document.getElementById('tableData').innerHTML=getHtml(htmlTemplate);$('#loader-wrapper3').fadeOut('slow');$('.page_pagination ul li').removeClass('active');$('.page_pagination ul li#page_'+page).addClass('active')})}